<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Boutique - Tous nos produits | FLUX</title>
    <meta name="description" content="Découvrez tous les produits FLUX : t-shirts, hoodies, accessoires streetwear premium. Livraison gratuite dès 50€.">
    <meta name="keywords" content="boutique flux, acheter streetwear, t-shirt premium, hoodie, accessoires mode">
    
    <!-- Google Consent Mode v2 -->
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('consent', 'default', {
            'ad_storage': 'denied',
            'ad_user_data': 'denied',
            'ad_personalization': 'denied',
            'analytics_storage': 'denied'
        });
        window.acceptCookies = function() {
            gtag('consent', 'update', {
                'ad_storage': 'granted',
                'ad_user_data': 'granted',
                'ad_personalization': 'granted',
                'analytics_storage': 'granted'
            });
            localStorage.setItem('cookieConsent', 'accepted');
            document.getElementById('cookieConsent').style.display = 'none';
        };
        window.refuseCookies = function() {
            gtag('consent', 'update', {
                'ad_storage': 'denied',
                'ad_user_data': 'denied',
                'ad_personalization': 'denied',
                'analytics_storage': 'denied'
            });
            localStorage.setItem('cookieConsent', 'refused');
            document.getElementById('cookieConsent').style.display = 'none';
        };
        window.addEventListener('DOMContentLoaded', function() {
            const consent = localStorage.getItem('cookieConsent');
            if (consent === 'accepted') {
                acceptCookies();
            } else if (consent === 'refused') {
                refuseCookies();
            } else {
                setTimeout(function() {
                    document.getElementById('cookieConsent').style.display = 'block';
                }, 1000);
            }
        });
    </script>
    
    <!-- Google AdSense -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5825303311354202"
     crossorigin="anonymous"></script>
    
    <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    
    <style>
        .shop-hero {
            background: var(--gray-100);
            padding: 4rem 4%;
            text-align: center;
        }
        .shop-hero h1 {
            font-family: var(--font-display);
            font-size: clamp(2.5rem, 6vw, 4rem);
            margin-bottom: 1rem;
        }
        .shop-hero p {
            color: var(--gray-600);
            font-size: 1.125rem;
            max-width: 600px;
            margin: 0 auto;
        }
        .shop-container {
            max-width: var(--container-max);
            margin: 0 auto;
            padding: 3rem 4%;
        }
        .shop-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            flex-wrap: wrap;
            gap: 1.5rem;
        }
        .results-info {
            font-size: 1rem;
            color: var(--gray-600);
        }
        .results-info strong {
            color: var(--black);
            font-weight: 700;
        }
        .shop-controls {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }
        .sort-select {
            padding: 0.75rem 1.5rem;
            border: 1px solid var(--gray-300);
            border-radius: var(--radius-sm);
            font-family: inherit;
            font-size: 0.9375rem;
            background: var(--white);
            cursor: pointer;
        }
        .filters-sidebar {
            display: flex;
            gap: 2rem;
            align-items: flex-start;
        }
        .sidebar-filters {
            width: 250px;
            flex-shrink: 0;
            position: sticky;
            top: 100px;
        }
        .filter-group {
            margin-bottom: 2rem;
            padding-bottom: 2rem;
            border-bottom: 1px solid var(--gray-200);
        }
        .filter-group:last-child {
            border-bottom: none;
        }
        .filter-group h3 {
            font-size: 1rem;
            font-weight: 700;
            margin-bottom: 1rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        .filter-option {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 0.75rem;
            cursor: pointer;
        }
        .filter-option input[type="checkbox"] {
            width: 18px;
            height: 18px;
            cursor: pointer;
        }
        .filter-option label {
            cursor: pointer;
            font-size: 0.9375rem;
            color: var(--gray-700);
        }
        .filter-option:hover label {
            color: var(--black);
        }
        .price-range {
            display: flex;
            gap: 1rem;
            align-items: center;
        }
        .price-input {
            width: 100px;
            padding: 0.5rem;
            border: 1px solid var(--gray-300);
            border-radius: var(--radius-sm);
            font-size: 0.875rem;
        }
        .clear-filters {
            width: 100%;
            padding: 0.75rem;
            background: var(--gray-100);
            border: 1px solid var(--gray-300);
            border-radius: var(--radius-sm);
            font-weight: 600;
            margin-top: 1rem;
        }
        .clear-filters:hover {
            background: var(--gray-200);
        }
        .products-section {
            flex: 1;
        }
        .no-results {
            text-align: center;
            padding: 4rem 2rem;
            color: var(--gray-500);
        }
        .no-results svg {
            width: 64px;
            height: 64px;
            margin: 0 auto 1rem;
            color: var(--gray-300);
        }
        @media (max-width: 1024px) {
            .filters-sidebar {
                flex-direction: column;
            }
            .sidebar-filters {
                width: 100%;
                position: relative;
                top: 0;
            }
        }
    </style>
</head>
<body>
    <!-- Cookie Consent -->
    <div id="cookieConsent" class="cookie-consent">
        <div class="cookie-content">
            <div class="cookie-icon">
                <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"></circle>
                    <circle cx="12" cy="12" r="1" fill="currentColor"></circle>
                    <circle cx="8" cy="10" r="1" fill="currentColor"></circle>
                    <circle cx="16" cy="10" r="1" fill="currentColor"></circle>
                    <circle cx="10" cy="15" r="1" fill="currentColor"></circle>
                    <circle cx="15" cy="14" r="1" fill="currentColor"></circle>
                </svg>
            </div>
            <div class="cookie-text">
                <h3>Nous respectons votre vie privée</h3>
                <p>Ce site utilise des cookies pour améliorer votre expérience. <a href="politique-cookies.html">En savoir plus</a></p>
            </div>
            <div class="cookie-actions">
                <button class="cookie-btn cookie-accept" onclick="acceptCookies()">Accepter tout</button>
                <button class="cookie-btn cookie-refuse" onclick="refuseCookies()">Refuser</button>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="header">
        <nav class="nav-container">
            <div class="logo"><a href="index.html">FLUX</a></div>
            <ul class="nav-menu">
                <li><a href="index.html">Accueil</a></li>
                <li><a href="boutique.html" class="active">Boutique</a></li>
                <li><a href="nouveautes.html">Nouveautés</a></li>
                <li><a href="blog.html">Blog</a></li>
                <li><a href="a-propos.html">À propos</a></li>
                <li><a href="contact.html">Contact</a></li>
            </ul>
            <div class="nav-actions">
                <button class="search-btn" onclick="toggleSearch()" aria-label="Rechercher">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="11" cy="11" r="8"></circle>
                        <path d="m21 21-4.35-4.35"></path>
                    </svg>
                </button>
                <button class="cart-btn" id="cartBtn" aria-label="Panier">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="9" cy="21" r="1"></circle>
                        <circle cx="20" cy="21" r="1"></circle>
                        <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path>
                    </svg>
                    <span class="cart-count" id="cartCount">0</span>
                </button>
            </div>
        </nav>
        
        <!-- Search Bar -->
        <div class="search-bar-full" id="searchBar" style="display: none;">
            <div class="container" style="max-width: 800px; padding: 2rem 4%;">
                <div style="position: relative;">
                    <input type="text" 
                           id="searchInput" 
                           placeholder="Rechercher des produits..." 
                           style="width: 100%; padding: 1.25rem 3rem 1.25rem 1.5rem; font-size: 1.125rem; border: 2px solid var(--gray-300); border-radius: var(--radius-md); font-family: inherit;"
                           autofocus>
                    <button onclick="toggleSearch()" style="position: absolute; right: 1rem; top: 50%; transform: translateY(-50%); background: none; border: none; cursor: pointer; padding: 0.5rem;">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="18" y1="6" x2="6" y2="18"></line>
                            <line x1="6" y1="6" x2="18" y2="18"></line>
                        </svg>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Shop Hero -->
    <section class="shop-hero">
        <h1>Notre Boutique</h1>
        <p>Découvrez l'intégralité de notre collection streetwear premium. Qualité supérieure, design unique, style urbain.</p>
    </section>

    <!-- Main Content -->
    <div class="shop-container">
        <div class="shop-top">
            <div class="results-info">
                <strong id="productCount">0</strong> produits trouvés
            </div>
            <div class="shop-controls">
                <select class="sort-select" id="sortSelect" onchange="sortProducts(this.value)">
                    <option value="default">Trier par</option>
                    <option value="name-asc">Nom (A-Z)</option>
                    <option value="name-desc">Nom (Z-A)</option>
                    <option value="price-asc">Prix croissant</option>
                    <option value="price-desc">Prix décroissant</option>
                    <option value="newest">Plus récents</option>
                </select>
            </div>
        </div>

        <div class="filters-sidebar">
            <!-- Sidebar Filters -->
            <aside class="sidebar-filters">
                <div class="filter-group">
                    <h3>Catégories</h3>
                    <div class="filter-option">
                        <input type="checkbox" id="cat-all" value="all" checked onchange="applyFilters()">
                        <label for="cat-all">Tous les produits</label>
                    </div>
                    <div class="filter-option">
                        <input type="checkbox" id="cat-tshirts" value="tshirts" onchange="applyFilters()">
                        <label for="cat-tshirts">T-Shirts</label>
                    </div>
                    <div class="filter-option">
                        <input type="checkbox" id="cat-hoodies" value="hoodies" onchange="applyFilters()">
                        <label for="cat-hoodies">Hoodies & Sweats</label>
                    </div>
                    <div class="filter-option">
                        <input type="checkbox" id="cat-accessories" value="accessories" onchange="applyFilters()">
                        <label for="cat-accessories">Accessoires</label>
                    </div>
                </div>

                <div class="filter-group">
                    <h3>Genre</h3>
                    <div class="filter-option">
                        <input type="checkbox" id="gender-men" value="men" onchange="applyFilters()">
                        <label for="gender-men">Homme</label>
                    </div>
                    <div class="filter-option">
                        <input type="checkbox" id="gender-women" value="women" onchange="applyFilters()">
                        <label for="gender-women">Femme</label>
                    </div>
                    <div class="filter-option">
                        <input type="checkbox" id="gender-unisex" value="unisex" onchange="applyFilters()">
                        <label for="gender-unisex">Unisexe</label>
                    </div>
                </div>

                <div class="filter-group">
                    <h3>Prix</h3>
                    <div class="price-range">
                        <input type="number" class="price-input" id="priceMin" placeholder="Min" min="0" onchange="applyFilters()">
                        <span>-</span>
                        <input type="number" class="price-input" id="priceMax" placeholder="Max" min="0" onchange="applyFilters()">
                    </div>
                </div>

                <button class="clear-filters" onclick="clearFilters()">Réinitialiser les filtres</button>
            </aside>

            <!-- Products Grid -->
            <section class="products-section">
                <div id="loadingState" class="loading">Chargement des produits...</div>
                <div id="productsGrid" class="products-grid" style="display: none;"></div>
                <div id="noResults" class="no-results" style="display: none;">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="11" cy="11" r="8"></circle>
                        <path d="m21 21-4.35-4.35"></path>
                    </svg>
                    <h3>Aucun produit trouvé</h3>
                    <p>Essayez de modifier vos critères de recherche</p>
                </div>
            </section>
        </div>
    </div>

    <!-- AdSense -->
    <div class="ad-container">
        <ins class="adsbygoogle"
             style="display:block"
             data-ad-client="ca-pub-5825303311354202"
             data-ad-slot="SLOT_1"
             data-ad-format="auto"
             data-full-width-responsive="true"></ins>
        <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-grid">
                <div class="footer-col">
                    <h3>FLUX</h3>
                    <p>Streetwear premium pour ceux qui osent se démarquer.</p>
                    <div class="social-links">
                        <a href="#" aria-label="Instagram">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <rect x="2" y="2" width="20" height="20" rx="5" ry="5"></rect>
                                <path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"></path>
                                <line x1="17.5" y1="6.5" x2="17.51" y2="6.5"></line>
                            </svg>
                        </a>
                        <a href="#" aria-label="Facebook">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"></path>
                            </svg>
                        </a>
                    </div>
                </div>
                <div class="footer-col">
                    <h4>Boutique</h4>
                    <ul>
                        <li><a href="nouveautes.html">Nouveautés</a></li>
                        <li><a href="boutique.html">Tous les produits</a></li>
                    </ul>
                </div>
                <div class="footer-col">
                    <h4>Aide</h4>
                    <ul>
                        <li><a href="contact.html">Contact</a></li>
                        <li><a href="cgv.html">CGV</a></li>
                    </ul>
                </div>
                <div class="footer-col">
                    <h4>Légal</h4>
                    <ul>
                        <li><a href="mentions-legales.html">Mentions légales</a></li>
                        <li><a href="politique-cookies.html">Cookies</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 FLUX. Tous droits réservés.</p>
            </div>
        </div>
    </footer>

    <!-- Cart Modal -->
    <div class="cart-overlay" id="cartOverlay"></div>
    <div class="cart-modal" id="cartModal">
        <div class="cart-header">
            <h2>Panier</h2>
            <button class="close-cart" id="closeCart">×</button>
        </div>
        <div class="cart-items" id="cartItems">
            <div class="empty-cart"><p>Votre panier est vide</p></div>
        </div>
        <div class="cart-footer">
            <div class="cart-total">
                <span>Total</span>
                <span id="cartTotal">0,00 €</span>
            </div>
            <button class="btn btn-primary btn-block" id="checkoutBtn">Commander</button>
        </div>
    </div>

    <div class="toast" id="toast"></div>

    <script src="script.js"></script>
    <script>
        // Search toggle
        function toggleSearch() {
            const searchBar = document.getElementById('searchBar');
            const isVisible = searchBar.style.display !== 'none';
            searchBar.style.display = isVisible ? 'none' : 'block';
            if (!isVisible) {
                document.getElementById('searchInput').focus();
            }
        }

        // Search input handler
        document.addEventListener('DOMContentLoaded', () => {
            const searchInput = document.getElementById('searchInput');
            if (searchInput) {
                searchInput.addEventListener('input', (e) => {
                    searchProducts(e.target.value);
                });
            }
            
            // Load products
            loadShopProducts();
        });

        // Load products for shop page
        async function loadShopProducts() {
            try {
                const response = await fetch(`${API_BASE}/products`);
                const data = await response.json();
                
                if (data.success && data.products && data.products.length > 0) {
                    window.allProducts = data.products;
                } else {
                    loadDemoProducts();
                }
                
                applyFilters();
                document.getElementById('loadingState').style.display = 'none';
                document.getElementById('productsGrid').style.display = 'grid';
            } catch (error) {
                loadDemoProducts();
                applyFilters();
                document.getElementById('loadingState').style.display = 'none';
                document.getElementById('productsGrid').style.display = 'grid';
            }
        }

        // Apply filters
        function applyFilters() {
            let filtered = [...(window.allProducts || state.products)];
            
            // Category filters
            const categories = [];
            if (document.getElementById('cat-tshirts').checked) categories.push('tshirts');
            if (document.getElementById('cat-hoodies').checked) categories.push('hoodies');
            if (document.getElementById('cat-accessories').checked) categories.push('accessories');
            
            if (categories.length > 0 && !document.getElementById('cat-all').checked) {
                filtered = filtered.filter(p => {
                    const name = (p.name || '').toLowerCase();
                    const category = (p.category || '').toLowerCase();
                    return categories.some(cat => name.includes(cat) || category.includes(cat));
                });
            }
            
            // Gender filters
            const genders = [];
            if (document.getElementById('gender-men').checked) genders.push('men');
            if (document.getElementById('gender-women').checked) genders.push('women');
            if (document.getElementById('gender-unisex').checked) genders.push('unisex');
            
            if (genders.length > 0) {
                filtered = filtered.filter(p => {
                    const type = p.type || '';
                    return genders.includes(type);
                });
            }
            
            // Price filters
            const minPrice = parseFloat(document.getElementById('priceMin').value) || 0;
            const maxPrice = parseFloat(document.getElementById('priceMax').value) || Infinity;
            filtered = filtered.filter(p => {
                const price = parseFloat(p.price) || 0;
                return price >= minPrice && price <= maxPrice;
            });
            
            displayShopProducts(filtered);
        }

        // Sort products
        function sortProducts(sortBy) {
            let filtered = [...(window.currentFiltered || [])];
            
            switch(sortBy) {
                case 'name-asc':
                    filtered.sort((a, b) => a.name.localeCompare(b.name));
                    break;
                case 'name-desc':
                    filtered.sort((a, b) => b.name.localeCompare(a.name));
                    break;
                case 'price-asc':
                    filtered.sort((a, b) => parseFloat(a.price) - parseFloat(b.price));
                    break;
                case 'price-desc':
                    filtered.sort((a, b) => parseFloat(b.price) - parseFloat(a.price));
                    break;
            }
            
            displayShopProducts(filtered);
        }

        // Display products
        function displayShopProducts(products) {
            window.currentFiltered = products;
            const grid = document.getElementById('productsGrid');
            const noResults = document.getElementById('noResults');
            
            document.getElementById('productCount').textContent = products.length;
            
            if (products.length === 0) {
                grid.style.display = 'none';
                noResults.style.display = 'block';
                return;
            }
            
            grid.style.display = 'grid';
            noResults.style.display = 'none';
            
            displayProducts(products, grid);
        }

        // Clear filters
        function clearFilters() {
            document.getElementById('cat-all').checked = true;
            document.querySelectorAll('.filter-option input[type="checkbox"]').forEach(cb => {
                if (cb.id !== 'cat-all') cb.checked = false;
            });
            document.getElementById('priceMin').value = '';
            document.getElementById('priceMax').value = '';
            document.getElementById('sortSelect').value = 'default';
            applyFilters();
        }
    </script>
</body>
</html>
